@using Sandbox;
@using Sandbox.UI;

@namespace Sauna
@inherits Panel
@attribute [StyleSheet]

<root>
	<label class="name dark">@PassportComponent.Fullname</label>

	<label class="weight-text dark">@(_weight) KG</label>
	<slider 
		class="weight"
		minimum=@(60) maximum=@(125) default=@(_weight) 
		@onvalueset=@(value => {
			_weight = (int)value.Value;
			Weight = MathX.Remap( (float)_weight, 60, 125, 0, 1 );
			Model.Morphs.Set( "fat", Weight );
			Model.Update( Time.Delta );
		} )
	/>

	<label class="height-text dark">@(_height) CM</label>
	<slider 
		class="height"
		minimum=@(150) maximum=@(195) default=@(_height) 
		@onvalueset=@(value => {
			_height = (int)value.Value;
			Height = MathX.Remap( (float)_height, 150, 195, -90, 80 );
			Model.SetAnimParameter( "height", Height );
			Model.Update( Time.Delta );
		} )
	/>

	<div class="confirm" @onclick=@CreatorComponent.NextStage>
		CONFIRM
	</div>
</root>

@code {
	public const int DEFAULT_WEIGHT = 70;
	public const int DEFAULT_HEIGHT = 178;

	private static int _weight = DEFAULT_WEIGHT;
	private static int _height = DEFAULT_HEIGHT;

	public static float Weight { get; set; }
	public static float Height { get; set; }

	private SceneModel model;
	public SceneModel Model
	{
		get
		{
			if ( model != null )
				return model;

			return model = CreatorComponent.All[CreatorComponent.Current].GameObject
				.Components.Get<SkinnedModelRenderer>( FindMode.EverythingInDescendants )
				.SceneModel;
		}
	}

	protected override int BuildHash()
	{
		return HashCode.Combine( _weight, _height );
	}
}
