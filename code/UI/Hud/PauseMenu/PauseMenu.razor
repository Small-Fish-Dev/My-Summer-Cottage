@namespace Sauna.UI
@attribute [StyleSheet]
@inherits Panel

<root>
	<div style="width: 50%; flex-direction: column;">
		<img class="title" src="ui/mainmenu/title.png" />
		<div style="flex-direction: column; justify-content: center; top: 38%; gap: 5px; width: 70%;">
			<SideButton
				ImagePath="ui/hud/goback.png"
				Title="Resume"
				Subtitle="Continue being Finnish"
				OnClick=@(() => { FullScreenManager.Instance.Display(FullScreenManager.FullScreenPanel.InGameHud); })
			/>

			<div style="height: 10px;" />

			<SideButton
				ImagePath="ui/hud/task_completed.png"
				Title="Tasks"
				Subtitle="Full history of your tasks"
				OnClick=@(() => { FullScreenManager.Instance.Display(FullScreenManager.FullScreenPanel.TaskLog); })
			/>
			<SideButton
				ImagePath="ui/hud/inv.png"
				Title="Inventory"
				Subtitle="Your inventory and stats"
				OnClick=@(() => { FullScreenManager.Instance.Display(FullScreenManager.FullScreenPanel.Inventory); })
			/>
			<SideButton
				ImagePath="ui/hud/fish_collection.png"
				Title="Fish Collection"
				Subtitle="All the kinds of fish you collected"
				OnClick=@(() => { FullScreenManager.Instance.Display(FullScreenManager.FullScreenPanel.FishLog); })
			/>
			<SideButton
				ImagePath="ui/hud/exit.png"
				Title="Quit"
				Subtitle="End this session and go back to the main menu"
				OnClick=@(() => 
				{ 
					GameNetworkSystem.Disconnect(); 
					MainMenu.PlayIntro = false; 
					SceneHandler.ChangeScene( SaunaScene.MainMenu ); 
				})
			/>
			<text class="disclaimer">Game progress will NOT be saved. You must finish the current day for progress to be saved.</text>
		</div>
	</div>
	<div style="width: 50%;">
		<div class="portraits">
			@{
				var players = Player.All.OrderBy((p) => p.Connection.IsHost);
				@foreach (var player in Player.All)
				{
					<PlayerPortrait Player=@player />
				}

				/*if ( players.Count() < NetworkManager.MAX_PLAYERS )
				{
					<div class="invite">+</div>
				}*/

				if ( Connection.Local.IsHost )
				{
					<div class="host-spacer" />
					<div class="host-info">
						<div class="text-container">
							<div>@_lobbyHeader</div>
							<div class="sub">@_lobbySub</div>
						</div>
						<div class="button" @onclick=@NetworkManager.ToggleLobby >
							<img class="image" src=@_lobbyIcon />
						</div>
					</div>
				}
			}
		</div>

		<div class="inputs">
			<button class="rebind" @onclick=@(() => Game.Overlay.ShowBinds())> Rebind Keys</button>

			<InputHint Hint="Task Log" Input=@InputAction.Tasks />
			<InputHint Hint="Inventory" Input=@InputAction.Inventory />
			<InputHint Hint="(Hold) Zoom" Input=@InputAction.Zoom />
			<InputHint Hint="(Hold) Voice Chat" Input=@InputAction.Voice />
			<InputHint Hint="(Hold + No Pants on) Pee" Input=@InputAction.Piss />
		</div>
	</div>
</root>

@code {
	private string _lobbyHeader => $"{(GameNetworkSystem.IsActive ? "Public" : "Private")} Lobby";
	private string _lobbySub => $"Click to make {(GameNetworkSystem.IsActive ? "private" : "public")}";
	private string _lobbyIcon => GameNetworkSystem.IsActive ? "ui/hud/lobby-public.png" : "ui/hud/lobby-closed.png";

	protected override int BuildHash()
	{
		return HashCode.Combine(GameNetworkSystem.IsActive, Player.All.HashCombine((p) => p.ConnectionID.GetHashCode()));
	}
}
