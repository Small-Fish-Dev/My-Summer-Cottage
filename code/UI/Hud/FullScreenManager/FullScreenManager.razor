@namespace Sauna.UI
@attribute [StyleSheet]
@inherits Panel

<root>
	@if ( Hud.Instance.GameTimeManager.IsDayOver && false ) // todo: make better
	{
		<RecapScreen />
	}
	else
		switch ( ActivePanel )
		{
			case FullScreenPanel.InGameHud:
				<InGameHud/>
				break;
			case FullScreenPanel.Inventory:
				<Inventory/>
				break;
			case FullScreenPanel.TaskLog:
				<TaskLog/>
				break;
			case FullScreenPanel.FishLog:
				<FishLog/>
				break;
			case FullScreenPanel.PauseMenu:
				<PauseMenu/>
				break;
			default:
				throw new ArgumentOutOfRangeException();
		}

	<Phone />
</root>

@code {
	public static FullScreenManager Instance { get; private set; }

	public enum FullScreenPanel
	{
		InGameHud,
		Inventory,
		TaskLog,
		FishLog,
		PauseMenu,
	}

	public FullScreenPanel ActivePanel { get; private set; } = FullScreenPanel.InGameHud;

	public FullScreenManager()
	{
		Instance = this;
	}

	public void Display( FullScreenPanel panel )
	{
		ActivePanel = panel;
	}

	public override void Tick()
	{
		if ( Input.EscapePressed )
			if ( ActivePanel == FullScreenPanel.InGameHud )
				Toggle( FullScreenPanel.PauseMenu );
			else
				Toggle( FullScreenPanel.InGameHud );

		if ( Input.Pressed( InputAction.Inventory ) )
			Toggle( FullScreenPanel.Inventory );

		if ( Input.Pressed( InputAction.Tasks ) )
			Toggle( FullScreenPanel.TaskLog );
	}

	private void Toggle( FullScreenPanel panel )
	{
		if ( ActivePanel == panel )
			ActivePanel = FullScreenPanel.InGameHud;
		else
			ActivePanel = panel;
	}

	public static bool Is( FullScreenPanel mode )
		=> FullScreenManager.Instance?.ActivePanel == mode;

	protected override int BuildHash()
	{
		return HashCode.Combine( Hud.Instance.GameTimeManager.IsDayOver, ActivePanel.GetHashCode() );
	}
}
